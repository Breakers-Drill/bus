# Bus Monitor - MQTT Bridge Setup

ะญัะพั ะฟัะพะตะบั ะฝะฐัััะฐะธะฒะฐะตั MQTT ะผะพัั ะผะตะถะดั ะดะฒัะผั ะฑัะพะบะตัะฐะผะธ:
- **mqtt-edge** (producer) - ะฝะฐ ะฟะพััั 1883
- **mqtt-cloud** (consumer) - ะฝะฐ ะฟะพััั 1884

## ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

- Docker ะธ Docker Compose ัััะฐะฝะพะฒะปะตะฝั
- ะะพััั 1883 ะธ 1884 ัะฒะพะฑะพะดะฝั ะฝะฐ ัะพััะต

## ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะัะฝะพะฒะฝัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั:

- `MQTT_TOPIC` - ัะพะฟะธะบ ะดะปั ะพัะฟัะฐะฒะบะธ/ะฟะพะปััะตะฝะธั ัะพะพะฑัะตะฝะธะน (ะฟะพ ัะผะพะปัะฐะฝะธั: `PLC/test`)
- `MQTT_BROKER_URL` - URL MQTT ะฑัะพะบะตัะฐ
- `MQTT_CLIENT_ID` - ID MQTT ะบะปะธะตะฝัะฐ

๐ **ะะพะดัะพะฑะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั**: [ENVIRONMENT.md](ENVIRONMENT.md)

## ะะฐัััะพะนะบะฐ

### 1. ะกะพะทะดะฐะฝะธะต ะพะฑัะตะน Docker ัะตัะธ

```bash
docker network create bus-monitor-network
```

### 2. ะะฐะฟััะบ Producer (Edge ะฑัะพะบะตั)

```bash
cd producer
docker-compose up -d
```

Producer ะทะฐะฟัััะธั:
- MQTT ะฑัะพะบะตั ะฝะฐ ะฟะพััั 1883
- Generator ัะตัะฒะธั ะดะปั ัะตััะธัะพะฒะฐะฝะธั

### 3. ะะฐะฟััะบ Consumer (Cloud ะฑัะพะบะตั + Monitor)

```bash
cd consumer
docker-compose up -d
```

Consumer ะทะฐะฟัััะธั:
- MQTT ะฑัะพะบะตั ะฝะฐ ะฟะพััั 1884
- MQTT Monitor ะดะปั ะพััะปะตะถะธะฒะฐะฝะธั ัะพะพะฑัะตะฝะธะน

## ะัะพะฒะตัะบะฐ ัะฐะฑะพัั

### ะัะพะฒะตัะบะฐ ัะตัะตะน
```bash
docker network ls
```

### ะัะพะฒะตัะบะฐ ะบะพะฝัะตะนะฝะตัะพะฒ
```bash
docker ps
```

### ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ
```bash
# Producer logs
docker logs mqtt-edge

# Consumer logs  
docker logs bus-monitor-mqtt-cloud
```

## ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Producer      โ    โ   Consumer      โ
โ   mqtt-edge     โโโโโบโ   mqtt-cloud    โ
โ   bus-generator โ    โ   bus-monitor   โ
โ   Port: 1883    โ    โ   Port: 1884    โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
```

- Producer ะพัะฟัะฐะฒะปัะตั ะดะฐะฝะฝัะต ะฝะฐ consumer ัะตัะตะท MQTT ะผะพัั
- ะัะธ ะฝะตะดะพัััะฟะฝะพััะธ consumer, producer ะบััะธััะตั ัะพะพะฑัะตะฝะธั
- ะะพัั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะตัะตะฟะพะดะบะปััะฐะตััั ะฟัะธ ะฒะพัััะฐะฝะพะฒะปะตะฝะธะธ ัะฒัะทะธ

## ะััะฐะฝะพะฒะบะฐ

```bash
# ะััะฐะฝะพะฒะธัั consumer
cd consumer && docker-compose down

# ะััะฐะฝะพะฒะธัั producer  
cd producer && docker-compose down

# ะฃะดะฐะปะธัั ัะตัั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
docker network rm bus-monitor-network
``` 